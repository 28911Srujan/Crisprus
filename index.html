<!DOCTYPE html>
<html>
<body>
    <h1>Live Editor</h1>
    <textarea id="myText" rows="5" cols="30">Loading content...</textarea><br>
    <button onclick="saveToGitHub()">Update text.txt</button>

    <script>
        const TOKEN = 'YOUR_TOKEN_HERE'; 
        const REPO = 'username/repo-name';
        const FILE_PATH = 'text.txt';

        // 1. Fetch current content when page opens
        async function loadFile() {
            const res = await fetch(`https://api.github.com/repos/${REPO}/contents/${FILE_PATH}`);
            const data = await res.json();
            document.getElementById('myText').value = atob(data.content);
            window.fileSha = data.sha; // Save this ID to update later
        }

        // 2. Save new content
        async function saveToGitHub() {
            const newContent = document.getElementById('myText').value;
            const res = await fetch(`https://api.github.com/repos/${REPO}/contents/${FILE_PATH}`, {
                method: 'PUT',
                headers: { 'Authorization': `token ${TOKEN}`, 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    message: "Web update",
                    content: btoa(newContent), // Convert to Base64
                    sha: window.fileSha
                })
            });
            if(res.ok) alert("Updated successfully!");
        }
        loadFile();
    </script>
</body>
</html>
